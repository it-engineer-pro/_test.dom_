============================================================================================================================================
    Вариант 0. Подготовить окружение для снижения количества проблем при работе по настройке.
    Используемые ВМ:
1. Клиентский узел 1 - Машина в ALT Wks. Является шлюзом с двумя интерфейсами. ws1.testlab.lan.
2. Сервер1 - ALTServer1. -- as1.testlab.lan.
3. Сервер2 - ALTServer2. -- as2.testlab.lan.
4. Сервер3 - ALTServer3. -- as3.testlab.lan.
5. Клиентский узел 1 - ALTWks. -- aw1.testlab.lan.
6. Клиентский узел 2 - ALTWks. -- as2.testlab.lan.
  Целевое состояние.
  Функциональные требования:
  -- Обеспечить подготовку выполнения задачи билета, исключая неявные и не определённые чётко в задании моменты.

Порядок выполнения:
+  -- выполнить именование ws1 через hostnamectl;
+  -- произвести установку unbound на ws1 и обеспечить разрешение имён dns для внутренней сети, без обращения к внешним DNS-серверам;
+  -- настроить chrony на шлюзовом сервере (ws1); настроить получение времени на остальных узлах сети в задании;
+  -- выполнить именование хостов через hostnamectl, обеспечить наличие полного имени для каждого хостав в текущем задании;
+  -- произвести настройку сети на хостах, исключить использование dhcp4 на узлах с серверными задачами (все кроме ws2);
+  -- отключить поддержку IPv6 как для сетевого стека, так и для работы с DNS;
+  -- произвести настройку /etc/net/ifaces/../resolve.conf, записать короткое и длинное имена всех хостов задания в файл /etc/hosts -- цель -- предварительно обеспечить разрешение внутренних имён без наличия DNS-сервера;
+  -- для тех заданий, где нет явного внутреннего резольвера, выполнить настройку resolv.conf на внутренний сервер DNS на ws1;
--  -- обеспечить наличие ключей шифрования для доступа по ключам в профиле администратора на хосте ws1;
+  -- доставить ssh-ключи на сторону клиентов от имени учётки с правами wheel;
+  -- создать каталог /root/.ssh; выполнить копирование ключей в папку /root/.ssh, проверить возможность доступа к консоли через root@hostname ;
+  -- произвести настройку запуска iptables, создать политики по умолчанию для цепочек INPUT/OUTPUT;
  -- проверить запуск севрера OpenSSH (enable --now), проверить файл /etc/ssh/sshd_config , создать правила разрешающие доступ для хоста ws1 по SSH;
+  -- задать правила определяющие доступ к сервисам к конкретном задании, провести перезагрузку узла, и убедиться в наличии корректных правил.
Минимум настроек, но всё вышеуказанное нужно проверить и реализовать, что бы обеспечить нормальное выполнение задания уже с привязкой конкретному билету.
При наличии реализованной предварительной настройки, все остальные обязательные условия задачи будут выполняться более увязано и логично.

============================================================================================================================================


============================================================================================================================================
    Вариант 10. DNS с репликацией между первичным и вторичным сервером с фильтрацией трафика.
    Используемые ВМ:
1. Клиентский узел - любая ВМ на выбор.
2. Сервер DNS (primary) - любая ВМ на выбор.
3. Сервер DNS (secondary)- любая ВМ на выбор.
  Целевое состояние.
  Функциональные требования:
- DNS-сервер с зоной test.dom (первичный по отношению к зоне) и зоной обратного просмотра, соответствующая IP-сети стенда.
- DNS-сервер, вторичный по отношению к обоим указанным зонам.
- репликация обеих зон работает при обновлении зон на первичном сервере.
- клиентский узел настроенный на разрешение имен через оба DNS-сервера.
  Требования безопасности:
- зонные трансферы возможны только между первичным и вторичным DNS-серверами, но не доступны с других узлов стенда.
- правила фильтрации трафика на обоих DNS-серверах разрешают прием запросов от клиентов и трафик репликации между серверами.
- правила фильтрации трафика позволяют выполнять обновление ПО на DNS-серверах.
- все остальные варианты сетевого взаимодействия с DNS-серверами блокируются.
  Методика проверки:
- проверка подключений с клиентского узла или любого другого узла стенда, кроме DNS-серверов.
- есть возможность выполнить запрос к DNS-серверу.
- нет возможности запросить трансфер зоны.
- утилитой nmap к любому другому порту - порты протоколов, не указанных в требованиях безопасности не должны быть доступны.
- проверка возможности выполнить обновление ПО серверов DNS.
--------------------------------------------------------------------------------------------------------------------------------------------
============================================================================================================================================
    Вариант 9. Dynamic DNS.
    Используемые ВМ:
1. Клиентский узел - любая ВМ на выбор2. Сервер DHCP - любая ВМ на выбор.
3. Сервер DNS - любая ВМ на выбор.
  Целевое состояние.
  Функциональные требования:
- DNS-сервер с зоной test.dom с поддержкой динамических обновлений по ключу.
- зона обратного просмотра, соответствующая IP-сети стенда с поддержкой динамических обновлений по ключу.
- DHCP-сервер, выдающий адреса IPv4-сети стенда и отправляющий обновление прямой и обратной зоны.
- клиентский узел настроенный на динамическое получение IPv4-адреса и параметров стека протоколов.
  Требования безопасности:
- обновление обеих зон DNS возможно только при предъявлении ключа.
- DHCP-сервер выдает адреса не пересекающиеся со статически заданными адресами узлов стенда.
- DNS-сервер обрабатывает рекурсивные запросы только с IP-адресов сети стенда.
  Методика проверки:
- проверка подключений с клиентского узла или любого другого узла стенда.
- нет возможности выполнить обновление зоны без предъявления правильного ключа.
- узел настроенный на динамическое получение адреса, получает адрес из сети стенда, при этом создаются записи в прямых и обратных зонах DNS.
DDNS
https://www.altlinux.org/DDNS
--------------------------------------------------------------------------------------------------------------------------------------------
============================================================================================================================================
    Вариант 1. HTTPS с самоподписанным сертификатом и фильтрацией трафика.
    Используемые ВМ:
1. Клиентский узел - любая ВМ на выбор.
2. Веб-сервер - любая ВМ на выбор.
  Целевое состояние.
  Функциональные требования:
- веб-сайт с адресом https://www.mydomain.ru по меньшей мере с одной статической Web-страницей произвольного содержания.
  Требования безопасности:
- web-сайт использует самоподписанный сертификат.
- параметры фильтрации трафика на веб-сервере разрешают подключения к серверу для получения доступа к веб-сайту, для управления сервером по протоколу SSH.
- параметры фильтрации трафика на веб-сервере разрешают исходящий трафик для обновления ПО сервера.
- параметры фильтрации трафика запрещают любые другие варианты взаимодействий кроме указанных.
  Методика проверки:
- проверка подключений с клиентского узла или любого другого узла стенда браузером по указанному в функциональных требованиях адресу - сайт должен открываться после внесения самоподписанного сертификата в список исключений утилитой nmap к любому другому порту - порты протоколов, не указанных в требованиях безопасности не должны быть доступны.
- проверка возможности выполнить обновление ПО веб-сервера.
...
Установка корневого сертификата
https://www.altlinux.org/%D0%A3%D1%81%D1%82%D0%B0%D0%BD%D0%BE%D0%B2%D0%BA%D0%B0_%D0%BA%D0%BE%D1%80%D0%BD%D0%B5%D0%B2%D0%BE%D0%B3%D0%BE_%D1%81%D0%B5%D1%80%D1%82%D0%B8%D1%84%D0%B8%D0%BA%D0%B0%D1%82%D0%B0
Создание самоподписанных сертификатов
https://www.altlinux.org/%D0%A1%D0%BE%D0%B7%D0%B4%D0%B0%D0%BD%D0%B8%D0%B5_%D1%81%D0%B0%D0%BC%D0%BE%D0%BF%D0%BE%D0%B4%D0%BF%D0%B8%D1%81%D0%B0%D0%BD%D0%BD%D1%8B%D1%85_%D1%81%D0%B5%D1%80%D1%82%D0%B8%D1%84%D0%B8%D0%BA%D0%B0%D1%82%D0%BE%D0%B2
Firewall start
https://www.altlinux.org/Firewall_start
Создание самоподписанных сертификатов
https://www.altlinux.org/%D0%A1%D0%BE%D0%B7%D0%B4%D0%B0%D0%BD%D0%B8%D0%B5_%D1%81%D0%B0%D0%BC%D0%BE%D0%BF%D0%BE%D0%B4%D0%BF%D0%B8%D1%81%D0%B0%D0%BD%D0%BD%D1%8B%D1%85_%D1%81%D0%B5%D1%80%D1%82%D0%B8%D1%84%D0%B8%D0%BA%D0%B0%D1%82%D0%BE%D0%B2
Создание сертификатов PKCS12
https://www.altlinux.org/%D0%A1%D0%BE%D0%B7%D0%B4%D0%B0%D0%BD%D0%B8%D0%B5_%D1%81%D0%B5%D1%80%D1%82%D0%B8%D1%84%D0%B8%D0%BA%D0%B0%D1%82%D0%BE%D0%B2_PKCS12
EnterpriseApps/Nginx
https://www.altlinux.org/EnterpriseApps/Nginx
Apache2
https://www.altlinux.org/EnterpriseApps/Apache2
--------------------------------------------------------------------------------------------------------------------------------------------
============================================================================================================================================
    Вариант 2. HTTPS c сертификатом от собственного УЦ.
    Используемые ВМ:
1. Клиентский узел - любая ВМ на выбор.
2. Веб-сервер, удостоверяющий центр - любая ВМ на выбор.
  Целевое состояние.
  Функциональные требования:
- веб-сайт с адресом https://www.mydomain.ru , по меньшей мере с одной статической Web-страницей произвольного содержания.
  Требования безопасности:
- web-сайт использует сертификат, выданный собственным удостоверяющем центром.
- сертификат удостоверяющего центра добавлен в базу сертификатов браузера клиентского узла.
  Методика проверки:
- проверка подключений с клиентского узла и и любого другого узла стенда браузером по указанному в функциональных требованиях адресу - сайт должен открываться, при этом соединение должно отображаться как защищенное.
- проверка возможности выполнить обновление ПО веб-сервера.
--------------------------------------------------------------------------------------------------------------------------------------------
============================================================================================================================================
    Вариант 5. Домен AD с фильтрацией трафика.
    Используемые ВМ:
1. Клиентский узел - любая ВМ на выбор.
2. Контроллер домена AD - любая ВМ на выбор.
  Целевое состояние.
  Функциональные требования:
домен Active Directory с именем test.dom .
в состав домена введены сервер и клиентский узел.
с клиентского узла возможен вход в домен под доменными УЗ: sambauser1 - пароль Pa$$word, sambauser2 - пароль Pa$$word .
  Требования безопасности:
- параметры фильтрации трафика на контроллере домена разрешают доступ к контроллеру домена по протоколам SSH, LDAP, SMB, Kerberos, NTP с узлов сети стенда.
- параметры фильтрации трафика на контроллере домена разрешают исходящий трафик для обновления ПО сервера.
- параметры фильтрации трафика запрещают любые другие варианты взаимодействий кроме указанных.
  Методика проверки:
- проверка подключений с клиентского узла должна быть возможность входа в систему под произвольной доменной учетной записью.
- проверка подключений с клиентского узла или любого другого узла стенда утилитой nmap к любому другому порту - порты протоколов, не указанных в требованиях безопасности не должны быть доступны.
- проверка возможности выполнить обновление ПО контроллера домена.
--------------------------------------------------------------------------------------------------------------------------------------------
ActiveDirectory
https://www.altlinux.org/ActiveDirectory
https://docs.altlinux.org/ru-RU/alt-server/10.1/html-single/alt-server/index.html#sambadc--chapter
FreeIPA/Ansible
https://www.altlinux.org/FreeIPA/Ansible
ActiveDirectory/FileShare
https://www.altlinux.org/ActiveDirectory/FileShare
============================================================================================================================================
    Вариант 3. SMB-сервер в составе домена AD.
    Используемые ВМ:
1. Клиентский узел - любая ВМ на выбор.
2. Контроллер домена AD - любая ВМ на выбор.
3. Сервер (SMB) в составе домена - любая ВМ на выбор.
  Целевое состояние.
  Функциональные требования:
- домен Active Directory с именем test.dom.
- в состав домена введены сервер и клиентский узел.
- с клиентского узла возможен вход в домен под доменными УЗ: sambauser1 - пароль Pa$$word, sambauser2 - пароль Pa$$word,
  Требования безопасности:
- с клиентского узла в составе домена под доменными УЗ по протоколу SMB возможен доступ к разделяемому каталогу smbshare на сервере в составе домена.
- доступ к каталогу sambashare под пользователем sambauser1 возможен только на чтение.
- доступ к каталогу sambashare под пользователем sambauser2 возможен на чтение и запись.
  Методика проверки:
- проверка входа в систему и подключений по протоколу SMB к разделяемому каталогу на сервере с клиентского узла под обоими доменными учетными записями.
- проверка возможности чтения файлов в разделяемом каталоге.
- проверка возможности записи в разделяемый каталог.
--------------------------------------------------------------------------------------------------------------------------------------------
============================================================================================================================================
    Вариант 4. Отказоустойчивая конфигурация AD.
    Используемые ВМ:
1. Клиентский узел - любая ВМ на выбор.
2. Контроллер домена AD - любая ВМ на выбор.
3. Второй контроллер домена AD - любая ВМ на выбор.
  Целевое состояние.
  Функциональные требования:
- домен Active Directory с именем test.dom.
- развернут резервный контроллер домена.
- в состав домена введен клиентский узел.
- с клиентского узла возможен вход в домен под доменными УЗ: sambauser1 - пароль Pa$$word, sambauser2 - пароль Pa$$word .
  Требования безопасности:
- с клиентского узла в составе домена под доменными УЗ возможен вход в систему.
- в случае если оба контроллера домена включены.
- в случае, если один из контроллеров домена (произвольный) выключен.
  Методика проверки:
- Проверка входа в систему клиентского узла под обоими доменными учетными записями.
- вход должен быть успешным в случае недоступности первого контроллера домена.
- вход должен быть успешным в случае недоступности второго контроллера домена.
--------------------------------------------------------------------------------------------------------------------------------------------
============================================================================================================================================
    Вариант 6. Прокси-сервер с аутентификацией и фильтрацией трафика.
    Используемые ВМ:
1. Клиентский узел - любая ВМ на выбор.
2. Сервер (прокси SQUID) - любая ВМ на выбор.
  Целевое состояние.
  Функциональные требования:
- на сервере - развернутый SQUID в непрозрачном режиме с использованием порта 3128 для обработки клиенских запросов.
- настроенная на SQUID аутентификация, по методу BASIC или DIGEST.
- пользователи для аутентификации на прокси: proxyuser1 - пароль netlab123, proxyuser2 - пароль netlab123 .
- настроенный на прокси браузер клиентского узла.
  Требования безопасности:
- подключение к интернету возможно только при условии настройки клиентского приложения на работу через прокси и только при условии успешной аутентификации на прокси сервере.
- параметры фильтрации трафика на прокси-сервере обеспечивают возможность подключения к прокси-серверу с узлов сети стенда.
- параметры фильтрации трафика на прокси-сервере разрешают исходящий трафик для выполнения прокси-сервером запросов пользователей.
- параметры фильтрации трафика на прокси-сервере разрешают исходящий трафик для обновления ПО сервера.
- параметры фильтрации трафика запрещают любые другие варианты взаимодействий кроме указанных выше.
  Методика проверки:
- проверка подключений с клиентского узла или любого другого узла стенда.
- проверка возможности доступа к интернету по протоколам HTTP/HTTPS при условии настройки браузера на proxy-сервер и корректного ввода данных аутентификации.
- проверка невозможности доступа к интернету без настройки на прокси сервер.
- проверка невозможности доступа к интернету при указании УЗ/паролей, отличных от: proxyuser1 - пароль netlab123, proxyuser2 - пароль netlab123 утилитой nmap - порты протоколов, не указанных в требованиях безопасности не должны быть доступны на прокси-сервере.
- проверка возможности выполнить обновление ПО прокси-сервера.
ActiveDirectory/Squid
https://www.altlinux.org/ActiveDirectory/Squid
--------------------------------------------------------------------------------------------------------------------------------------------
============================================================================================================================================
    Вариант 8. Домен FreeIPA с фильтрацией трафика.
    Используемые ВМ:
1. Клиентский узел - любая ВМ на выбор.
2. Сервер FreeIPA - любая ВМ на выбор.
  Целевое состояние.
  Функциональные требования:
- домен FreeIPA с именем test.dom .
- в состав домена введены сервер и клиентский узел.
- с клиентского узла возможен вход в домен под доменными УЗ: ipauser1 - пароль Pa$$word, ipauser2 - пароль Pa$$word .
  Требования безопасности:
- параметры фильтрации трафика на сервере FreeIPA разрешают доступ к серверу по протоколам HTTPS, LDAP, SMB, Kerberos, NTP с узлов сети стенда.
- параметры фильтрации трафика на сервере FreeIPA разрешают исходящий трафик для обновления ПО сервера.
- параметры фильтрации трафика запрещают любые другие варианты взаимодействий кроме указанных.
  Методика проверки:
- проверка подключений с клиентского узла должна быть возможность входа в систему под произвольной учетной записью домена IPA.
- проверка подключений с клиентского узла или любого другого узла стенда.
- утилитой nmap к любому другому порту - порты протоколов, не указанных в требованиях безопасности не должны быть доступны.
- проверка возможности выполнить обновление ПО сервера FreeIPA.
--------------------------------------------------------------------------------------------------------------------------------------------
============================================================================================================================================
    Вариант 7. Отказоустойчивая конфигурация FreeIPA.
    Используемые ВМ:
1. Клиентский узел - любая ВМ на выбор.
2. Первый сервер FreeIPA - любая ВМ на выбор.
3. Второй сервер FreeIPA - любая ВМ на выбор.
  Целевое состояние.
  Функциональные требования:
- домен FreeIPA с именем test.dom .
- развернут резервный сервер FreeIPA.
- в состав домена введен клиентский узел.
- с клиентского узла возможен вход в домен под доменными УЗ: ipaauser1 - пароль Pa$$word, ipauser2 - пароль Pa$$word .
  Требования безопасности:
- с клиентского узла в составе домена под доменными УЗ возможен вход в систему.
  - в случае если оба сервера FreeIPA включены.
  - в случае, если один из серверов FreeIPA (произвольный) выключен.
  Методика проверки:
- проверка входа в систему клиентского узла под обоими доменными учетными записями.
- вход должен быть успешным в случае недоступности первого сервера FreeIPA.
- вход должен быть успешным в случае недоступности второго сервера FreeIPA.
--------------------------------------------------------------------------------------------------------------------------------------------
FreeIPA
https://www.altlinux.org/FreeIPA
============================================================================================================================================


ALT K8s:
https://www.altlinux.org/ALT_Container_OS_%D0%BF%D0%BE%D0%B4%D0%B2%D0%B5%D1%82%D0%BA%D0%B0_K8S._%D0%A1%D0%BE%D0%B7%D0%B4%D0%B0%D0%BD%D0%B8%D0%B5_HA_%D0%BA%D0%BB%D0%B0%D1%81%D1%82%D0%B5%D1%80%D0%B0
https://www.altlinux.org/Keepalived


